
# HG changeset patch
# User welpy-cw <h.w.forms@arcor.de>
# Date 1761691934 14400
# Node ID 131ae901e5b7959f6b86b4f47ac5ecb9a04576d1
# Parent  ce32fff11c3328b5a6345b4c0a0280cc5297e778
Bug 1991417 - Fix cmd_newMessage for empty folder pane. r=mkmelin

Differential Revision: https://phabricator.services.mozilla.com/D270139

diff --git a/mail/base/content/mailCommon.js b/mail/base/content/mailCommon.js
--- a/mail/base/content/mailCommon.js
+++ b/mail/base/content/mailCommon.js
@@ -864,21 +864,19 @@ var commandController = {
   /**
    * Calls the ComposeMessage function with the desired type, and proper default
    * based on the event that fired it.
    *
    * @param {nsIMsgCompType} composeType - The nsIMsgCompType type to pass.
    * @param {Event} [event] - The event that triggered the call.
    */
   _composeMsgByType(composeType, event) {
-    // If we're the hidden window, then we're not going to have a gFolderDisplay
-    // to work out existing folders, so just use null.
     const msgFolder = gFolder;
     const msgUris =
-      gFolder || gViewWrapper.isSynthetic
+      gFolder || gViewWrapper?.isSynthetic
         ? gDBView?.getURIsForSelection()
         : [window.gMessageURI];
 
     let messagePaneBrowser;
     let autodetectCharset;
     let selection;
     if (!mailContextMenu.selectionIsOverridden) {
       if (window.messageBrowser) {

