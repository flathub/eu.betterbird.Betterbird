
# HG changeset patch
# User Kai Engert <kaie@kuix.de>
# Date 1757611095 0
# Node ID b243b7f8dcd4e3fb8a9ee91476ea08b1bc1afdb6
# Parent  1da5909cf4e411e65213c3dd8ba0491ec398b12a
Bug 1988230 - Add CSP to confirmPubkeyImport.xhtml. r=mkmelin

Differential Revision: https://phabricator.services.mozilla.com/D264625

diff --git a/mail/extensions/openpgp/content/ui/confirmPubkeyImport.xhtml b/mail/extensions/openpgp/content/ui/confirmPubkeyImport.xhtml
--- a/mail/extensions/openpgp/content/ui/confirmPubkeyImport.xhtml
+++ b/mail/extensions/openpgp/content/ui/confirmPubkeyImport.xhtml
@@ -6,16 +6,20 @@
 <!DOCTYPE html>
 <html
   xmlns="http://www.w3.org/1999/xhtml"
   xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
   xmlns:html="http://www.w3.org/1999/xhtml"
   scrolling="false"
 >
   <head>
+    <meta
+      http-equiv="Content-Security-Policy"
+      content="default-src chrome:; script-src chrome: 'unsafe-inline' moz-src:; style-src chrome: 'unsafe-inline'"
+    />
     <link rel="stylesheet" href="chrome://global/skin/global.css" />
     <link
       rel="stylesheet"
       href="chrome://messenger/skin/openpgp/inlineNotification.css"
     />
     <link
       rel="stylesheet"
       href="chrome://messenger/skin/openpgp/confirmPubkeyImport.css"

